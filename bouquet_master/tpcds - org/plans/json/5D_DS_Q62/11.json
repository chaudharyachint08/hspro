{"QUERY PLAN": [{"Plan": {"Node-Type": "Sort", "Startup-Cost": "29276.25", "Total-Cost": "29276.32", "Plan-Rows": "30", "Plan-Width": "46", "Output": {"Item": ["ship_mode.sm_type", "web_site.web_name", "(sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 30) THEN 1 ELSE 0 END))", "(sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 30) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 60)) THEN 1 ELSE 0 END))", "(sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 60) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 90)) THEN 1 ELSE 0 END))", "(sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 90) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 120)) THEN 1 ELSE 0 END))", "(sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 120) THEN 1 ELSE 0 END))"]}, "Sort-Key": {"Item": ["ship_mode.sm_type", "web_site.web_name"]}, "Plans": {"Plan": {"Node-Type": "Aggregate", "Strategy": "Hashed", "Parent-Relationship": "Outer", "Startup-Cost": "29275.21", "Total-Cost": "29275.51", "Plan-Rows": "30", "Plan-Width": "46", "Output": {"Item": ["ship_mode.sm_type", "web_site.web_name", "sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 30) THEN 1 ELSE 0 END)", "sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 30) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 60)) THEN 1 ELSE 0 END)", "sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 60) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 90)) THEN 1 ELSE 0 END)", "sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 90) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) <= 120)) THEN 1 ELSE 0 END)", "sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) > 120) THEN 1 ELSE 0 END)"]}, "Group-Key": {"Item": ["ship_mode.sm_type", "web_site.web_name"]}, "Plans": {"Plan": {"Node-Type": "Hash Join", "Parent-Relationship": "Outer", "Join-Type": "Inner", "Startup-Cost": "101.09", "Total-Cost": "28831.66", "Plan-Rows": "7714", "Plan-Width": "46", "Output": {"Item": ["web_sales.ws_ship_date_sk", "web_sales.ws_sold_date_sk", "ship_mode.sm_type", "web_site.web_name"]}, "Hash-Cond": "(web_sales.ws_ship_mode_sk = ship_mode.sm_ship_mode_sk)", "Plans": {"Plan": [{"Node-Type": "Hash Join", "Parent-Relationship": "Outer", "Join-Type": "Inner", "Startup-Cost": "99.64", "Total-Cost": "28724.15", "Plan-Rows": "7715", "Plan-Width": "19", "Output": {"Item": ["web_sales.ws_ship_date_sk", "web_sales.ws_sold_date_sk", "web_sales.ws_ship_mode_sk", "web_site.web_name"]}, "Hash-Cond": "(web_sales.ws_warehouse_sk = warehouse.w_warehouse_sk)", "Plans": {"Plan": [{"Node-Type": "Hash Join", "Parent-Relationship": "Outer", "Join-Type": "Inner", "Startup-Cost": "98.53", "Total-Cost": "28616.94", "Plan-Rows": "7718", "Plan-Width": "23", "Output": {"Item": ["web_sales.ws_ship_date_sk", "web_sales.ws_sold_date_sk", "web_sales.ws_warehouse_sk", "web_sales.ws_ship_mode_sk", "web_site.web_name"]}, "Hash-Cond": "(web_sales.ws_ship_date_sk = date_dim.d_date_sk)", "Plans": {"Plan": [{"Node-Type": "Nested Loop", "Parent-Relationship": "Outer", "Join-Type": "Inner", "Startup-Cost": "78.05", "Total-Cost": "27682.07", "Plan-Rows": "223255", "Plan-Width": "23", "Output": {"Item": ["web_sales.ws_ship_date_sk", "web_sales.ws_sold_date_sk", "web_sales.ws_warehouse_sk", "web_sales.ws_ship_mode_sk", "web_site.web_name"]}, "Plans": {"Plan": [{"Node-Type": "Seq Scan", "Parent-Relationship": "Outer", "Relation-Name": "web_site", "Schema": "public", "Alias": "web_site", "Startup-Cost": "0.00", "Total-Cost": "2.30", "Plan-Rows": "30", "Plan-Width": "11", "Output": {"Item": ["web_site.web_site_sk", "web_site.web_site_id", "web_site.web_rec_start_date", "web_site.web_rec_end_date", "web_site.web_name", "web_site.web_open_date_sk", "web_site.web_close_date_sk", "web_site.web_class", "web_site.web_manager", "web_site.web_mkt_id", "web_site.web_mkt_class", "web_site.web_mkt_desc", "web_site.web_market_manager", "web_site.web_company_id", "web_site.web_company_name", "web_site.web_street_number", "web_site.web_street_name", "web_site.web_street_type", "web_site.web_suite_number", "web_site.web_city", "web_site.web_county", "web_site.web_state", "web_site.web_zip", "web_site.web_country", "web_site.web_gmt_offset", "web_site.web_tax_percentage"]}}, {"Node-Type": "Bitmap Heap Scan", "Parent-Relationship": "Inner", "Relation-Name": "web_sales", "Schema": "public", "Alias": "web_sales", "Startup-Cost": "78.05", "Total-Cost": "848.24", "Plan-Rows": "7442", "Plan-Width": "20", "Output": {"Item": ["web_sales.ws_sold_date_sk", "web_sales.ws_sold_time_sk", "web_sales.ws_ship_date_sk", "web_sales.ws_item_sk", "web_sales.ws_bill_customer_sk", "web_sales.ws_bill_cdemo_sk", "web_sales.ws_bill_hdemo_sk", "web_sales.ws_bill_addr_sk", "web_sales.ws_ship_customer_sk", "web_sales.ws_ship_cdemo_sk", "web_sales.ws_ship_hdemo_sk", "web_sales.ws_ship_addr_sk", "web_sales.ws_web_page_sk", "web_sales.ws_web_site_sk", "web_sales.ws_ship_mode_sk", "web_sales.ws_warehouse_sk", "web_sales.ws_promo_sk", "web_sales.ws_order_number", "web_sales.ws_quantity", "web_sales.ws_wholesale_cost", "web_sales.ws_list_price", "web_sales.ws_sales_price", "web_sales.ws_ext_discount_amt", "web_sales.ws_ext_sales_price", "web_sales.ws_ext_wholesale_cost", "web_sales.ws_ext_list_price", "web_sales.ws_ext_tax", "web_sales.ws_coupon_amt", "web_sales.ws_ext_ship_cost", "web_sales.ws_net_paid", "web_sales.ws_net_paid_inc_tax", "web_sales.ws_net_paid_inc_ship", "web_sales.ws_net_paid_inc_ship_tax", "web_sales.ws_net_profit"]}, "Recheck-Cond": "(web_sales.ws_web_site_sk = web_site.web_site_sk)", "Plans": {"Plan": {"Node-Type": "Bitmap Index Scan", "Parent-Relationship": "Outer", "Index-Name": "web_sales_ws_web_site_sk_idx", "Startup-Cost": "0.00", "Total-Cost": "76.19", "Plan-Rows": "7442", "Plan-Width": "0", "Index-Cond": "(web_sales.ws_web_site_sk = web_site.web_site_sk)"}}}]}}, {"Node-Type": "Hash", "Parent-Relationship": "Inner", "Startup-Cost": "15.95", "Total-Cost": "15.95", "Plan-Rows": "363", "Plan-Width": "4", "Output": {"Item": "date_dim.d_date_sk"}, "Plans": {"Plan": {"Node-Type": "Index Scan", "Parent-Relationship": "Outer", "Scan-Direction": "Forward", "Index-Name": "date_dim_d_year_idx", "Relation-Name": "date_dim", "Schema": "public", "Alias": "date_dim", "Startup-Cost": "0.29", "Total-Cost": "15.95", "Plan-Rows": "363", "Plan-Width": "4", "Output": {"Item": "date_dim.d_date_sk"}, "Index-Cond": "(date_dim.d_year = 2001)"}}}]}}, {"Node-Type": "Hash", "Parent-Relationship": "Inner", "Startup-Cost": "1.05", "Total-Cost": "1.05", "Plan-Rows": "5", "Plan-Width": "4", "Output": {"Item": "warehouse.w_warehouse_sk"}, "Plans": {"Plan": {"Node-Type": "Seq Scan", "Parent-Relationship": "Outer", "Relation-Name": "warehouse", "Schema": "public", "Alias": "warehouse", "Startup-Cost": "0.00", "Total-Cost": "1.05", "Plan-Rows": "5", "Plan-Width": "4", "Output": {"Item": "warehouse.w_warehouse_sk"}}}}]}}, {"Node-Type": "Hash", "Parent-Relationship": "Inner", "Startup-Cost": "1.20", "Total-Cost": "1.20", "Plan-Rows": "20", "Plan-Width": "35", "Output": {"Item": ["ship_mode.sm_type", "ship_mode.sm_ship_mode_sk"]}, "Plans": {"Plan": {"Node-Type": "Seq Scan", "Parent-Relationship": "Outer", "Relation-Name": "ship_mode", "Schema": "public", "Alias": "ship_mode", "Startup-Cost": "0.00", "Total-Cost": "1.20", "Plan-Rows": "20", "Plan-Width": "35", "Output": {"Item": ["ship_mode.sm_type", "ship_mode.sm_ship_mode_sk"]}}}}]}}}}}}}]}