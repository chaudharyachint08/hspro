<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Group</Node-Type>
      <Startup-Cost>113900213.80</Startup-Cost>
      <Total-Cost>116847450.37</Total-Cost>
      <Plan-Rows>450000</Plan-Rows>
      <Plan-Width>125</Plan-Width>
      <Output>
        <Item>item.i_item_id</Item>
        <Item>item.i_item_desc</Item>
        <Item>item.i_current_price</Item>
      </Output>
      <Group-Key>
        <Item>item.i_item_id</Item>
        <Item>item.i_item_desc</Item>
        <Item>item.i_current_price</Item>
      </Group-Key>
      <Plans>
        <Plan>
          <Node-Type>Sort</Node-Type>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Startup-Cost>113900213.80</Startup-Cost>
          <Total-Cost>114637022.95</Total-Cost>
          <Plan-Rows>294723657</Plan-Rows>
          <Plan-Width>125</Plan-Width>
          <Output>
            <Item>item.i_item_id</Item>
            <Item>item.i_item_desc</Item>
            <Item>item.i_current_price</Item>
          </Output>
          <Sort-Key>
            <Item>item.i_item_id</Item>
            <Item>item.i_item_desc</Item>
            <Item>item.i_current_price</Item>
          </Sort-Key>
          <Plans>
            <Plan>
              <Node-Type>Hash Join</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Join-Type>Inner</Join-Type>
              <Startup-Cost>501763.54</Startup-Cost>
              <Total-Cost>50019401.71</Total-Cost>
              <Plan-Rows>294723657</Plan-Rows>
              <Plan-Width>125</Plan-Width>
              <Output>
                <Item>item.i_item_id</Item>
                <Item>item.i_item_desc</Item>
                <Item>item.i_current_price</Item>
              </Output>
              <Hash-Cond>(store_sales.ss_sold_date_sk = date_dim.d_date_sk)</Hash-Cond>
              <Plans>
                <Plan>
                  <Node-Type>Hash Join</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Join-Type>Inner</Join-Type>
                  <Startup-Cost>496988.50</Startup-Cost>
                  <Total-Cost>43534780.22</Total-Cost>
                  <Plan-Rows>353260988</Plan-Rows>
                  <Plan-Width>129</Plan-Width>
                  <Output>
                    <Item>store_sales.ss_sold_date_sk</Item>
                    <Item>item.i_item_id</Item>
                    <Item>item.i_item_desc</Item>
                    <Item>item.i_current_price</Item>
                  </Output>
                  <Hash-Cond>(store_sales.ss_store_sk = store.s_store_sk)</Hash-Cond>
                  <Plans>
                    <Plan>
                      <Node-Type>Hash Join</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Join-Type>Inner</Join-Type>
                      <Startup-Cost>496641.00</Startup-Cost>
                      <Total-Cost>37363258.64</Total-Cost>
                      <Plan-Rows>422170272</Plan-Rows>
                      <Plan-Width>133</Plan-Width>
                      <Output>
                        <Item>store_sales.ss_sold_date_sk</Item>
                        <Item>store_sales.ss_store_sk</Item>
                        <Item>item.i_item_id</Item>
                        <Item>item.i_item_desc</Item>
                        <Item>item.i_current_price</Item>
                      </Output>
                      <Hash-Cond>(store_sales.ss_item_sk = item.i_item_sk)</Hash-Cond>
                      <Plans>
                        <Plan>
                          <Node-Type>Seq Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Relation-Name>store_sales</Relation-Name>
                          <Schema>public</Schema>
                          <Alias>store_sales</Alias>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>20124650.24</Total-Cost>
                          <Plan-Rows>720065024</Plan-Rows>
                          <Plan-Width>12</Plan-Width>
                          <Output>
                            <Item>store_sales.ss_sold_date_sk</Item>
                            <Item>store_sales.ss_item_sk</Item>
                            <Item>store_sales.ss_store_sk</Item>
                          </Output>
                        </Plan>
                        <Plan>
                          <Node-Type>Hash</Node-Type>
                          <Parent-Relationship>Inner</Parent-Relationship>
                          <Startup-Cost>352500.00</Startup-Cost>
                          <Total-Cost>352500.00</Total-Cost>
                          <Plan-Rows>4500000</Plan-Rows>
                          <Plan-Width>129</Plan-Width>
                          <Output>
                            <Item>item.i_item_id</Item>
                            <Item>item.i_item_desc</Item>
                            <Item>item.i_current_price</Item>
                            <Item>item.i_item_sk</Item>
                          </Output>
                          <Plans>
                            <Plan>
                              <Node-Type>Seq Scan</Node-Type>
                              <Parent-Relationship>Outer</Parent-Relationship>
                              <Relation-Name>item</Relation-Name>
                              <Schema>public</Schema>
                              <Alias>item</Alias>
                              <Startup-Cost>0.00</Startup-Cost>
                              <Total-Cost>352500.00</Total-Cost>
                              <Plan-Rows>4500000</Plan-Rows>
                              <Plan-Width>129</Plan-Width>
                              <Output>
                                <Item>item.i_item_id</Item>
                                <Item>item.i_item_desc</Item>
                                <Item>item.i_current_price</Item>
                                <Item>item.i_item_sk</Item>
                              </Output>
                            </Plan>
                          </Plans>
                        </Plan>
                      </Plans>
                    </Plan>
                    <Plan>
                      <Node-Type>Hash</Node-Type>
                      <Parent-Relationship>Inner</Parent-Relationship>
                      <Startup-Cost>310.00</Startup-Cost>
                      <Total-Cost>310.00</Total-Cost>
                      <Plan-Rows>3000</Plan-Rows>
                      <Plan-Width>4</Plan-Width>
                      <Output>
                        <Item>store.s_store_sk</Item>
                      </Output>
                      <Plans>
                        <Plan>
                          <Node-Type>Seq Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Relation-Name>store</Relation-Name>
                          <Schema>public</Schema>
                          <Alias>store</Alias>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>310.00</Total-Cost>
                          <Plan-Rows>3000</Plan-Rows>
                          <Plan-Width>4</Plan-Width>
                          <Output>
                            <Item>store.s_store_sk</Item>
                          </Output>
                          <Filter>(store.s_state = ANY ('{TN,TN,TN,TN,TN,TN,TN,TN}'::bpchar[]))</Filter>
                        </Plan>
                      </Plans>
                    </Plan>
                  </Plans>
                </Plan>
                <Plan>
                  <Node-Type>Hash</Node-Type>
                  <Parent-Relationship>Inner</Parent-Relationship>
                  <Startup-Cost>3633.66</Startup-Cost>
                  <Total-Cost>3633.66</Total-Cost>
                  <Plan-Rows>91311</Plan-Rows>
                  <Plan-Width>4</Plan-Width>
                  <Output>
                    <Item>date_dim.d_date_sk</Item>
                  </Output>
                  <Plans>
                    <Plan>
                      <Node-Type>Index Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Scan-Direction>Forward</Scan-Direction>
                      <Index-Name>date_dim_d_year_idx</Index-Name>
                      <Relation-Name>date_dim</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>date_dim</Alias>
                      <Startup-Cost>0.31</Startup-Cost>
                      <Total-Cost>3633.66</Total-Cost>
                      <Plan-Rows>91311</Plan-Rows>
                      <Plan-Width>4</Plan-Width>
                      <Output>
                        <Item>date_dim.d_date_sk</Item>
                      </Output>
                      <Index-Cond>(date_dim.d_year = 2001)</Index-Cond>
                    </Plan>
                  </Plans>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
  </Query>
</explain>