<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Sort</Node-Type>
      <Startup-Cost>24572.20</Startup-Cost>
      <Total-Cost>24572.27</Total-Cost>
      <Plan-Rows>30</Plan-Rows>
      <Plan-Width>46</Plan-Width>
      <Output>
        <Item>ship_mode.sm_type</Item>
        <Item>web_site.web_name</Item>
        <Item>(sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 30) THEN 1 ELSE 0 END))</Item>
        <Item>(sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 30) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 60)) THEN 1 ELSE 0 END))</Item>
        <Item>(sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 60) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 90)) THEN 1 ELSE 0 END))</Item>
        <Item>(sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 90) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 120)) THEN 1 ELSE 0 END))</Item>
        <Item>(sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 120) THEN 1 ELSE 0 END))</Item>
      </Output>
      <Sort-Key>
        <Item>ship_mode.sm_type</Item>
        <Item>web_site.web_name</Item>
      </Sort-Key>
      <Plans>
        <Plan>
          <Node-Type>Aggregate</Node-Type>
          <Strategy>Hashed</Strategy>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Startup-Cost>24571.16</Startup-Cost>
          <Total-Cost>24571.46</Total-Cost>
          <Plan-Rows>30</Plan-Rows>
          <Plan-Width>46</Plan-Width>
          <Output>
            <Item>ship_mode.sm_type</Item>
            <Item>web_site.web_name</Item>
            <Item>sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 30) THEN 1 ELSE 0 END)</Item>
            <Item>sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 30) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 60)) THEN 1 ELSE 0 END)</Item>
            <Item>sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 60) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 90)) THEN 1 ELSE 0 END)</Item>
            <Item>sum(CASE WHEN (((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 90) AND ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &lt;= 120)) THEN 1 ELSE 0 END)</Item>
            <Item>sum(CASE WHEN ((web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk) &gt; 120) THEN 1 ELSE 0 END)</Item>
          </Output>
          <Group-Key>
            <Item>ship_mode.sm_type</Item>
            <Item>web_site.web_name</Item>
          </Group-Key>
          <Plans>
            <Plan>
              <Node-Type>Nested Loop</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Join-Type>Inner</Join-Type>
              <Startup-Cost>58.23</Startup-Cost>
              <Total-Cost>24373.93</Total-Cost>
              <Plan-Rows>3430</Plan-Rows>
              <Plan-Width>46</Plan-Width>
              <Output>
                <Item>web_sales.ws_ship_date_sk</Item>
                <Item>web_sales.ws_sold_date_sk</Item>
                <Item>ship_mode.sm_type</Item>
                <Item>web_site.web_name</Item>
              </Output>
              <Join-Filter>(web_sales.ws_warehouse_sk = warehouse.w_warehouse_sk)</Join-Filter>
              <Plans>
                <Plan>
                  <Node-Type>Hash Join</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Join-Type>Inner</Join-Type>
                  <Startup-Cost>58.23</Startup-Cost>
                  <Total-Cost>24115.55</Total-Cost>
                  <Plan-Rows>3431</Plan-Rows>
                  <Plan-Width>50</Plan-Width>
                  <Output>
                    <Item>web_sales.ws_ship_date_sk</Item>
                    <Item>web_sales.ws_sold_date_sk</Item>
                    <Item>web_sales.ws_warehouse_sk</Item>
                    <Item>ship_mode.sm_type</Item>
                    <Item>web_site.web_name</Item>
                  </Output>
                  <Hash-Cond>(web_sales.ws_ship_mode_sk = ship_mode.sm_ship_mode_sk)</Hash-Cond>
                  <Plans>
                    <Plan>
                      <Node-Type>Hash Join</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Join-Type>Inner</Join-Type>
                      <Startup-Cost>56.78</Startup-Cost>
                      <Total-Cost>24066.92</Total-Cost>
                      <Plan-Rows>3432</Plan-Rows>
                      <Plan-Width>23</Plan-Width>
                      <Output>
                        <Item>web_sales.ws_ship_date_sk</Item>
                        <Item>web_sales.ws_sold_date_sk</Item>
                        <Item>web_sales.ws_warehouse_sk</Item>
                        <Item>web_sales.ws_ship_mode_sk</Item>
                        <Item>web_site.web_name</Item>
                      </Output>
                      <Hash-Cond>(web_sales.ws_ship_date_sk = date_dim.d_date_sk)</Hash-Cond>
                      <Plans>
                        <Plan>
                          <Node-Type>Nested Loop</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Join-Type>Inner</Join-Type>
                          <Startup-Cost>36.30</Startup-Cost>
                          <Total-Cost>23639.87</Total-Cost>
                          <Plan-Rows>99264</Plan-Rows>
                          <Plan-Width>23</Plan-Width>
                          <Output>
                            <Item>web_sales.ws_ship_date_sk</Item>
                            <Item>web_sales.ws_sold_date_sk</Item>
                            <Item>web_sales.ws_warehouse_sk</Item>
                            <Item>web_sales.ws_ship_mode_sk</Item>
                            <Item>web_site.web_name</Item>
                          </Output>
                          <Plans>
                            <Plan>
                              <Node-Type>Seq Scan</Node-Type>
                              <Parent-Relationship>Outer</Parent-Relationship>
                              <Relation-Name>web_site</Relation-Name>
                              <Schema>public</Schema>
                              <Alias>web_site</Alias>
                              <Startup-Cost>0.00</Startup-Cost>
                              <Total-Cost>2.30</Total-Cost>
                              <Plan-Rows>30</Plan-Rows>
                              <Plan-Width>11</Plan-Width>
                              <Output>
                                <Item>web_site.web_site_sk</Item>
                                <Item>web_site.web_site_id</Item>
                                <Item>web_site.web_rec_start_date</Item>
                                <Item>web_site.web_rec_end_date</Item>
                                <Item>web_site.web_name</Item>
                                <Item>web_site.web_open_date_sk</Item>
                                <Item>web_site.web_close_date_sk</Item>
                                <Item>web_site.web_class</Item>
                                <Item>web_site.web_manager</Item>
                                <Item>web_site.web_mkt_id</Item>
                                <Item>web_site.web_mkt_class</Item>
                                <Item>web_site.web_mkt_desc</Item>
                                <Item>web_site.web_market_manager</Item>
                                <Item>web_site.web_company_id</Item>
                                <Item>web_site.web_company_name</Item>
                                <Item>web_site.web_street_number</Item>
                                <Item>web_site.web_street_name</Item>
                                <Item>web_site.web_street_type</Item>
                                <Item>web_site.web_suite_number</Item>
                                <Item>web_site.web_city</Item>
                                <Item>web_site.web_county</Item>
                                <Item>web_site.web_state</Item>
                                <Item>web_site.web_zip</Item>
                                <Item>web_site.web_country</Item>
                                <Item>web_site.web_gmt_offset</Item>
                                <Item>web_site.web_tax_percentage</Item>
                              </Output>
                            </Plan>
                            <Plan>
                              <Node-Type>Bitmap Heap Scan</Node-Type>
                              <Parent-Relationship>Inner</Parent-Relationship>
                              <Relation-Name>web_sales</Relation-Name>
                              <Schema>public</Schema>
                              <Alias>web_sales</Alias>
                              <Startup-Cost>36.30</Startup-Cost>
                              <Total-Cost>754.83</Total-Cost>
                              <Plan-Rows>3309</Plan-Rows>
                              <Plan-Width>20</Plan-Width>
                              <Output>
                                <Item>web_sales.ws_sold_date_sk</Item>
                                <Item>web_sales.ws_sold_time_sk</Item>
                                <Item>web_sales.ws_ship_date_sk</Item>
                                <Item>web_sales.ws_item_sk</Item>
                                <Item>web_sales.ws_bill_customer_sk</Item>
                                <Item>web_sales.ws_bill_cdemo_sk</Item>
                                <Item>web_sales.ws_bill_hdemo_sk</Item>
                                <Item>web_sales.ws_bill_addr_sk</Item>
                                <Item>web_sales.ws_ship_customer_sk</Item>
                                <Item>web_sales.ws_ship_cdemo_sk</Item>
                                <Item>web_sales.ws_ship_hdemo_sk</Item>
                                <Item>web_sales.ws_ship_addr_sk</Item>
                                <Item>web_sales.ws_web_page_sk</Item>
                                <Item>web_sales.ws_web_site_sk</Item>
                                <Item>web_sales.ws_ship_mode_sk</Item>
                                <Item>web_sales.ws_warehouse_sk</Item>
                                <Item>web_sales.ws_promo_sk</Item>
                                <Item>web_sales.ws_order_number</Item>
                                <Item>web_sales.ws_quantity</Item>
                                <Item>web_sales.ws_wholesale_cost</Item>
                                <Item>web_sales.ws_list_price</Item>
                                <Item>web_sales.ws_sales_price</Item>
                                <Item>web_sales.ws_ext_discount_amt</Item>
                                <Item>web_sales.ws_ext_sales_price</Item>
                                <Item>web_sales.ws_ext_wholesale_cost</Item>
                                <Item>web_sales.ws_ext_list_price</Item>
                                <Item>web_sales.ws_ext_tax</Item>
                                <Item>web_sales.ws_coupon_amt</Item>
                                <Item>web_sales.ws_ext_ship_cost</Item>
                                <Item>web_sales.ws_net_paid</Item>
                                <Item>web_sales.ws_net_paid_inc_tax</Item>
                                <Item>web_sales.ws_net_paid_inc_ship</Item>
                                <Item>web_sales.ws_net_paid_inc_ship_tax</Item>
                                <Item>web_sales.ws_net_profit</Item>
                              </Output>
                              <Recheck-Cond>(web_sales.ws_web_site_sk = web_site.web_site_sk)</Recheck-Cond>
                              <Plans>
                                <Plan>
                                  <Node-Type>Bitmap Index Scan</Node-Type>
                                  <Parent-Relationship>Outer</Parent-Relationship>
                                  <Index-Name>web_sales_ws_web_site_sk_idx</Index-Name>
                                  <Startup-Cost>0.00</Startup-Cost>
                                  <Total-Cost>35.47</Total-Cost>
                                  <Plan-Rows>3309</Plan-Rows>
                                  <Plan-Width>0</Plan-Width>
                                  <Index-Cond>(web_sales.ws_web_site_sk = web_site.web_site_sk)</Index-Cond>
                                </Plan>
                              </Plans>
                            </Plan>
                          </Plans>
                        </Plan>
                        <Plan>
                          <Node-Type>Hash</Node-Type>
                          <Parent-Relationship>Inner</Parent-Relationship>
                          <Startup-Cost>15.95</Startup-Cost>
                          <Total-Cost>15.95</Total-Cost>
                          <Plan-Rows>363</Plan-Rows>
                          <Plan-Width>4</Plan-Width>
                          <Output>
                            <Item>date_dim.d_date_sk</Item>
                          </Output>
                          <Plans>
                            <Plan>
                              <Node-Type>Index Scan</Node-Type>
                              <Parent-Relationship>Outer</Parent-Relationship>
                              <Scan-Direction>Forward</Scan-Direction>
                              <Index-Name>date_dim_d_year_idx</Index-Name>
                              <Relation-Name>date_dim</Relation-Name>
                              <Schema>public</Schema>
                              <Alias>date_dim</Alias>
                              <Startup-Cost>0.29</Startup-Cost>
                              <Total-Cost>15.95</Total-Cost>
                              <Plan-Rows>363</Plan-Rows>
                              <Plan-Width>4</Plan-Width>
                              <Output>
                                <Item>date_dim.d_date_sk</Item>
                              </Output>
                              <Index-Cond>(date_dim.d_year = 2001)</Index-Cond>
                            </Plan>
                          </Plans>
                        </Plan>
                      </Plans>
                    </Plan>
                    <Plan>
                      <Node-Type>Hash</Node-Type>
                      <Parent-Relationship>Inner</Parent-Relationship>
                      <Startup-Cost>1.20</Startup-Cost>
                      <Total-Cost>1.20</Total-Cost>
                      <Plan-Rows>20</Plan-Rows>
                      <Plan-Width>35</Plan-Width>
                      <Output>
                        <Item>ship_mode.sm_type</Item>
                        <Item>ship_mode.sm_ship_mode_sk</Item>
                      </Output>
                      <Plans>
                        <Plan>
                          <Node-Type>Seq Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Relation-Name>ship_mode</Relation-Name>
                          <Schema>public</Schema>
                          <Alias>ship_mode</Alias>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>1.20</Total-Cost>
                          <Plan-Rows>20</Plan-Rows>
                          <Plan-Width>35</Plan-Width>
                          <Output>
                            <Item>ship_mode.sm_type</Item>
                            <Item>ship_mode.sm_ship_mode_sk</Item>
                          </Output>
                        </Plan>
                      </Plans>
                    </Plan>
                  </Plans>
                </Plan>
                <Plan>
                  <Node-Type>Materialize</Node-Type>
                  <Parent-Relationship>Inner</Parent-Relationship>
                  <Startup-Cost>0.00</Startup-Cost>
                  <Total-Cost>1.07</Total-Cost>
                  <Plan-Rows>5</Plan-Rows>
                  <Plan-Width>4</Plan-Width>
                  <Output>
                    <Item>warehouse.w_warehouse_sk</Item>
                  </Output>
                  <Plans>
                    <Plan>
                      <Node-Type>Seq Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Relation-Name>warehouse</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>warehouse</Alias>
                      <Startup-Cost>0.00</Startup-Cost>
                      <Total-Cost>1.05</Total-Cost>
                      <Plan-Rows>5</Plan-Rows>
                      <Plan-Width>4</Plan-Width>
                      <Output>
                        <Item>warehouse.w_warehouse_sk</Item>
                      </Output>
                    </Plan>
                  </Plans>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
  </Query>
</explain>