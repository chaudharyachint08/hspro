<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Sort</Node-Type>
      <Startup-Cost>16985.33</Startup-Cost>
      <Total-Cost>16986.70</Total-Cost>
      <Plan-Rows>545</Plan-Rows>
      <Plan-Width>65</Plan-Width>
      <Output>
        <Item>dt.d_year</Item>
        <Item>item.i_brand_id</Item>
        <Item>item.i_brand</Item>
        <Item>(sum(store_sales.ss_ext_sales_price))</Item>
      </Output>
      <Sort-Key>
        <Item>dt.d_year</Item>
        <Item>(sum(store_sales.ss_ext_sales_price))</Item>
        <Item>item.i_brand_id</Item>
      </Sort-Key>
      <Plans>
        <Plan>
          <Node-Type>Aggregate</Node-Type>
          <Strategy>Hashed</Strategy>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Startup-Cost>16953.75</Startup-Cost>
          <Total-Cost>16960.56</Total-Cost>
          <Plan-Rows>545</Plan-Rows>
          <Plan-Width>65</Plan-Width>
          <Output>
            <Item>dt.d_year</Item>
            <Item>item.i_brand_id</Item>
            <Item>item.i_brand</Item>
            <Item>sum(store_sales.ss_ext_sales_price)</Item>
          </Output>
          <Group-Key>
            <Item>dt.d_year</Item>
            <Item>item.i_brand</Item>
            <Item>item.i_brand_id</Item>
          </Group-Key>
          <Plans>
            <Plan>
              <Node-Type>Hash Join</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Join-Type>Inner</Join-Type>
              <Startup-Cost>2274.26</Startup-Cost>
              <Total-Cost>16912.37</Total-Cost>
              <Plan-Rows>4138</Plan-Rows>
              <Plan-Width>65</Plan-Width>
              <Output>
                <Item>dt.d_year</Item>
                <Item>store_sales.ss_ext_sales_price</Item>
                <Item>item.i_brand_id</Item>
                <Item>item.i_brand</Item>
              </Output>
              <Hash-Cond>(store_sales.ss_sold_date_sk = dt.d_date_sk)</Hash-Cond>
              <Plans>
                <Plan>
                  <Node-Type>Nested Loop</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Join-Type>Inner</Join-Type>
                  <Startup-Cost>4.91</Startup-Cost>
                  <Total-Cost>14470.43</Total-Cost>
                  <Plan-Rows>13121</Plan-Rows>
                  <Plan-Width>65</Plan-Width>
                  <Output>
                    <Item>store_sales.ss_ext_sales_price</Item>
                    <Item>store_sales.ss_sold_date_sk</Item>
                    <Item>item.i_brand_id</Item>
                    <Item>item.i_brand</Item>
                  </Output>
                  <Plans>
                    <Plan>
                      <Node-Type>Bitmap Heap Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Relation-Name>item</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>item</Alias>
                      <Startup-Cost>2.02</Startup-Cost>
                      <Total-Cost>89.01</Total-Cost>
                      <Plan-Rows>82</Plan-Rows>
                      <Plan-Width>59</Plan-Width>
                      <Output>
                        <Item>item.i_item_sk</Item>
                        <Item>item.i_item_id</Item>
                        <Item>item.i_rec_start_date</Item>
                        <Item>item.i_rec_end_date</Item>
                        <Item>item.i_item_desc</Item>
                        <Item>item.i_current_price</Item>
                        <Item>item.i_wholesale_cost</Item>
                        <Item>item.i_brand_id</Item>
                        <Item>item.i_brand</Item>
                        <Item>item.i_class_id</Item>
                        <Item>item.i_class</Item>
                        <Item>item.i_category_id</Item>
                        <Item>item.i_category</Item>
                        <Item>item.i_manufact_id</Item>
                        <Item>item.i_manufact</Item>
                        <Item>item.i_size</Item>
                        <Item>item.i_formulation</Item>
                        <Item>item.i_color</Item>
                        <Item>item.i_units</Item>
                        <Item>item.i_container</Item>
                        <Item>item.i_manager_id</Item>
                        <Item>item.i_product_name</Item>
                      </Output>
                      <Recheck-Cond>(item.i_manufact_id &lt;= 3)</Recheck-Cond>
                      <Plans>
                        <Plan>
                          <Node-Type>Bitmap Index Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Index-Name>item_i_manufact_id_idx</Index-Name>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>2.00</Total-Cost>
                          <Plan-Rows>82</Plan-Rows>
                          <Plan-Width>0</Plan-Width>
                          <Index-Cond>(item.i_manufact_id &lt;= 3)</Index-Cond>
                        </Plan>
                      </Plans>
                    </Plan>
                    <Plan>
                      <Node-Type>Bitmap Heap Scan</Node-Type>
                      <Parent-Relationship>Inner</Parent-Relationship>
                      <Relation-Name>store_sales</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>store_sales</Alias>
                      <Startup-Cost>2.89</Startup-Cost>
                      <Total-Cost>173.63</Total-Cost>
                      <Plan-Rows>175</Plan-Rows>
                      <Plan-Width>14</Plan-Width>
                      <Output>
                        <Item>store_sales.ss_sold_date_sk</Item>
                        <Item>store_sales.ss_sold_time_sk</Item>
                        <Item>store_sales.ss_item_sk</Item>
                        <Item>store_sales.ss_customer_sk</Item>
                        <Item>store_sales.ss_cdemo_sk</Item>
                        <Item>store_sales.ss_hdemo_sk</Item>
                        <Item>store_sales.ss_addr_sk</Item>
                        <Item>store_sales.ss_store_sk</Item>
                        <Item>store_sales.ss_promo_sk</Item>
                        <Item>store_sales.ss_ticket_number</Item>
                        <Item>store_sales.ss_quantity</Item>
                        <Item>store_sales.ss_wholesale_cost</Item>
                        <Item>store_sales.ss_list_price</Item>
                        <Item>store_sales.ss_sales_price</Item>
                        <Item>store_sales.ss_ext_discount_amt</Item>
                        <Item>store_sales.ss_ext_sales_price</Item>
                        <Item>store_sales.ss_ext_wholesale_cost</Item>
                        <Item>store_sales.ss_ext_list_price</Item>
                        <Item>store_sales.ss_ext_tax</Item>
                        <Item>store_sales.ss_coupon_amt</Item>
                        <Item>store_sales.ss_net_paid</Item>
                        <Item>store_sales.ss_net_paid_inc_tax</Item>
                        <Item>store_sales.ss_net_profit</Item>
                      </Output>
                      <Recheck-Cond>(store_sales.ss_item_sk = item.i_item_sk)</Recheck-Cond>
                      <Plans>
                        <Plan>
                          <Node-Type>Bitmap Index Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Index-Name>store_sales_pkey</Index-Name>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>2.84</Total-Cost>
                          <Plan-Rows>175</Plan-Rows>
                          <Plan-Width>0</Plan-Width>
                          <Index-Cond>(store_sales.ss_item_sk = item.i_item_sk)</Index-Cond>
                        </Plan>
                      </Plans>
                    </Plan>
                  </Plans>
                </Plan>
                <Plan>
                  <Node-Type>Hash</Node-Type>
                  <Parent-Relationship>Inner</Parent-Relationship>
                  <Startup-Cost>1967.69</Startup-Cost>
                  <Total-Cost>1967.69</Total-Cost>
                  <Plan-Rows>24133</Plan-Rows>
                  <Plan-Width>8</Plan-Width>
                  <Output>
                    <Item>dt.d_year</Item>
                    <Item>dt.d_date_sk</Item>
                  </Output>
                  <Plans>
                    <Plan>
                      <Node-Type>Bitmap Heap Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Relation-Name>date_dim</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>dt</Alias>
                      <Startup-Cost>261.02</Startup-Cost>
                      <Total-Cost>1967.69</Total-Cost>
                      <Plan-Rows>24133</Plan-Rows>
                      <Plan-Width>8</Plan-Width>
                      <Output>
                        <Item>dt.d_year</Item>
                        <Item>dt.d_date_sk</Item>
                      </Output>
                      <Recheck-Cond>(dt.d_moy &lt;= 4)</Recheck-Cond>
                      <Plans>
                        <Plan>
                          <Node-Type>Bitmap Index Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Index-Name>date_dim_d_moy_idx</Index-Name>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>254.99</Total-Cost>
                          <Plan-Rows>24133</Plan-Rows>
                          <Plan-Width>0</Plan-Width>
                          <Index-Cond>(dt.d_moy &lt;= 4)</Index-Cond>
                        </Plan>
                      </Plans>
                    </Plan>
                  </Plans>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
  </Query>
</explain>